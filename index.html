<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>chinese-stroke-order-generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        html, body {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            background: #fff; /* 浅蓝色背景 */
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
        }
        #character-container {
            width: 500px;
            height: 500px;
            position: relative;
            z-index: 2;
        }
    </style>
</head>
<body>
    <div id="character-container">
        <svg width="500" height="500" style="position: absolute; top: 0; left: 0; pointer-events: none; z-index: -1;">
            <rect x="0" y="0" width="500" height="500" fill="none" stroke="#D3D3D3" stroke-width="2" />
            <line x1="0" y1="0" x2="500" y2="500" stroke="#D3D3D3" stroke-width="1" stroke-dasharray="10 10" />
            <line x1="500" y1="0" x2="0" y2="500" stroke="#D3D3D3" stroke-width="1" stroke-dasharray="10 10" />
            <line x1="250" y1="0" x2="250" y2="500" stroke="#D3D3D3" stroke-width="1" stroke-dasharray="10 10" />
            <line x1="0" y1="250" x2="500" y2="250" stroke="#D3D3D3" stroke-width="1" stroke-dasharray="10 10" />
        </svg>
    </div>
    <script src="./scripts/hanzi-writer.min.js"></script>
    <script>
        // 从URL参数获取汉字
        const urlParams = new URLSearchParams(window.location.search);
        const character = urlParams.get('char') || '中';
        
        const writer = HanziWriter.create('character-container', character, {
            width: 500,
            height: 500,
            padding: 10,
            strokeColor: '#000000',
            strokeWidth: 5, // 增加笔画宽度以适应更大的尺寸
            showCharacter: false,
            showOutline: true,
            delayBetweenStrokes: 1000, // 笔画之间的延迟，让动画更慢
            delayBetweenLoops: 0,
            strokeAnimationDuration: 2000, // 每个笔画的动画时长，让动画更慢
            radicalColor: '#FF0000', // 红色笔画高亮
        });
        
        // 暴露writer对象供外部访问
        window.writer = writer;
        
        // 用于通知外部动画已准备好
        window.animationReady = false;
        window.animationStarted = false;
        window.animationFinished = false; // 新增：动画完成标志
        window.animationProgress = 0;
        
        // 封装启动动画的方法，支持回调
        window.startAnimation = function() {
            window.animationStarted = true;
            window.animationFinished = false;
            writer.animateCharacter({
                onProgress: (progress) => {
                    window.animationProgress = progress;
                },
                onComplete: () => {
                    window.animationFinished = true;
                }
            });
        };
        
        // hanzi-writer的create方法已经加载了字符，等待一小段时间确保渲染完成
        setTimeout(() => {
            window.animationReady = true;
        }, 1600);
    </script>
</body>
</html>

